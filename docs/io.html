<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Reading, Plotting, Querying &amp; Validating | The lidR package</title>
  <meta name="description" content="A guide to the lidR package" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Reading, Plotting, Querying &amp; Validating | The lidR package" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A guide to the lidR package" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Reading, Plotting, Querying &amp; Validating | The lidR package" />
  
  <meta name="twitter:description" content="A guide to the lidR package" />
  

<meta name="author" content="Jean-Romain Roussel, Tristan R.H. Goodbody, Piotr Tompalski" />


<meta name="date" content="2023-03-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="gnd.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZBLHENEPMT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZBLHENEPMT');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="io.html"><a href="io.html"><i class="fa fa-check"></i><b>2</b> Reading, Plotting, Querying &amp; Validating</a>
<ul>
<li class="chapter" data-level="2.1" data-path="io.html"><a href="io.html#read"><i class="fa fa-check"></i><b>2.1</b> Reading LiDAR data using <code>readLAS</code></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="io.html"><a href="io.html#select"><i class="fa fa-check"></i><b>2.1.1</b> Parameter <code>select</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="io.html"><a href="io.html#filter"><i class="fa fa-check"></i><b>2.1.2</b> Parameter <code>filter</code></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="io.html"><a href="io.html#asprs-compliance"><i class="fa fa-check"></i><b>2.2</b> Validating lidar data</a></li>
<li class="chapter" data-level="2.3" data-path="io.html"><a href="io.html#plot"><i class="fa fa-check"></i><b>2.3</b> Plotting</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="io.html"><a href="io.html#plot-3d"><i class="fa fa-check"></i><b>2.3.1</b> Basic 3D rendering</a></li>
<li class="chapter" data-level="2.3.2" data-path="io.html"><a href="io.html#plot-overlay"><i class="fa fa-check"></i><b>2.3.2</b> Overlays</a></li>
<li class="chapter" data-level="2.3.3" data-path="io.html"><a href="io.html#plot-advanced"><i class="fa fa-check"></i><b>2.3.3</b> Advanced 3D rendering</a></li>
<li class="chapter" data-level="2.3.4" data-path="io.html"><a href="io.html#voxel-rendering"><i class="fa fa-check"></i><b>2.3.4</b> Voxel rendering</a></li>
<li class="chapter" data-level="2.3.5" data-path="io.html"><a href="io.html#plot-crossection"><i class="fa fa-check"></i><b>2.3.5</b> Cross sections 2D rendering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gnd.html"><a href="gnd.html"><i class="fa fa-check"></i><b>3</b> Ground classification</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gnd.html"><a href="gnd.html#pmf"><i class="fa fa-check"></i><b>3.1</b> Progressive Morphological Filter</a></li>
<li class="chapter" data-level="3.2" data-path="gnd.html"><a href="gnd.html#csf"><i class="fa fa-check"></i><b>3.2</b> Cloth Simulation Function</a></li>
<li class="chapter" data-level="3.3" data-path="gnd.html"><a href="gnd.html#mcc"><i class="fa fa-check"></i><b>3.3</b> Multiscale Curvature Classification (MCC)</a></li>
<li class="chapter" data-level="3.4" data-path="gnd.html"><a href="gnd.html#edge-artifact"><i class="fa fa-check"></i><b>3.4</b> Edge artifacts</a></li>
<li class="chapter" data-level="3.5" data-path="gnd.html"><a href="gnd.html#method-selection"><i class="fa fa-check"></i><b>3.5</b> How to choose a method and its parameters?</a></li>
<li class="chapter" data-level="3.6" data-path="gnd.html"><a href="gnd.html#other"><i class="fa fa-check"></i><b>3.6</b> Other methods</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dtm.html"><a href="dtm.html"><i class="fa fa-check"></i><b>4</b> Digital terrain model</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dtm.html"><a href="dtm.html#tin"><i class="fa fa-check"></i><b>4.1</b> Triangular irregular network</a></li>
<li class="chapter" data-level="4.2" data-path="dtm.html"><a href="dtm.html#idw"><i class="fa fa-check"></i><b>4.2</b> Invert distance weighting</a></li>
<li class="chapter" data-level="4.3" data-path="dtm.html"><a href="dtm.html#kriging"><i class="fa fa-check"></i><b>4.3</b> Kriging</a></li>
<li class="chapter" data-level="4.4" data-path="dtm.html"><a href="dtm.html#dtm-pros-cons"><i class="fa fa-check"></i><b>4.4</b> Pros and cons</a></li>
<li class="chapter" data-level="4.5" data-path="dtm.html"><a href="dtm.html#dtm-other"><i class="fa fa-check"></i><b>4.5</b> Other methods</a></li>
<li class="chapter" data-level="4.6" data-path="dtm.html"><a href="dtm.html#hillshade"><i class="fa fa-check"></i><b>4.6</b> Render shaded DTM</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="norm.html"><a href="norm.html"><i class="fa fa-check"></i><b>5</b> Height normalization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="norm.html"><a href="norm.html#norm-dtm"><i class="fa fa-check"></i><b>5.1</b> DTM normalization</a></li>
<li class="chapter" data-level="5.2" data-path="norm.html"><a href="norm.html#norm-point-cloud"><i class="fa fa-check"></i><b>5.2</b> Point cloud normalization</a></li>
<li class="chapter" data-level="5.3" data-path="norm.html"><a href="norm.html#hybrid-method"><i class="fa fa-check"></i><b>5.3</b> Hybrid method</a></li>
<li class="chapter" data-level="5.4" data-path="norm.html"><a href="norm.html#norm-pros-cons"><i class="fa fa-check"></i><b>5.4</b> Pros and cons</a></li>
<li class="chapter" data-level="5.5" data-path="norm.html"><a href="norm.html#norm-reverse"><i class="fa fa-check"></i><b>5.5</b> Reversing normalization</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chm.html"><a href="chm.html"><i class="fa fa-check"></i><b>6</b> Digital Surface Model and Canopy Height model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chm.html"><a href="chm.html#p2r"><i class="fa fa-check"></i><b>6.1</b> Point-to-raster</a></li>
<li class="chapter" data-level="6.2" data-path="chm.html"><a href="chm.html#chm-tin"><i class="fa fa-check"></i><b>6.2</b> Triangulation</a></li>
<li class="chapter" data-level="6.3" data-path="chm.html"><a href="chm.html#pitfree"><i class="fa fa-check"></i><b>6.3</b> Pit-free algorithm</a></li>
<li class="chapter" data-level="6.4" data-path="chm.html"><a href="chm.html#chm-post-process"><i class="fa fa-check"></i><b>6.4</b> Post-processing a CHM</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="itd-its.html"><a href="itd-its.html"><i class="fa fa-check"></i><b>7</b> Indivitual tree dectection and segmentation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="itd-its.html"><a href="itd-its.html#itd"><i class="fa fa-check"></i><b>7.1</b> Individual Tree Detection (ITD)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="itd-its.html"><a href="itd-its.html#lmffw"><i class="fa fa-check"></i><b>7.1.1</b> Local Maximum Filter with fixed windows size</a></li>
<li class="chapter" data-level="7.1.2" data-path="itd-its.html"><a href="itd-its.html#lmfvw"><i class="fa fa-check"></i><b>7.1.2</b> Local Maximum Filter with variable windows size</a></li>
<li class="chapter" data-level="7.1.3" data-path="itd-its.html"><a href="itd-its.html#lmfchm"><i class="fa fa-check"></i><b>7.1.3</b> Local Maximum Filter on a CHM</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="itd-its.html"><a href="itd-its.html#its"><i class="fa fa-check"></i><b>7.2</b> Individual Tree Segmentation (ITS)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="itd-its.html"><a href="itd-its.html#its-cloud"><i class="fa fa-check"></i><b>7.2.1</b> Segmentation of the point-cloud</a></li>
<li class="chapter" data-level="7.2.2" data-path="itd-its.html"><a href="itd-its.html#its-chm"><i class="fa fa-check"></i><b>7.2.2</b> Segmentation of the CHM</a></li>
<li class="chapter" data-level="7.2.3" data-path="itd-its.html"><a href="itd-its.html#its-comparaison"><i class="fa fa-check"></i><b>7.2.3</b> Comparaison of tree segmentations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="metrics.html"><a href="metrics.html"><i class="fa fa-check"></i><b>8</b> Derived metrics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="metrics.html"><a href="metrics.html#metrics-basics"><i class="fa fa-check"></i><b>8.1</b> The basics</a></li>
<li class="chapter" data-level="8.2" data-path="metrics.html"><a href="metrics.html#metrics-user-defined"><i class="fa fa-check"></i><b>8.2</b> User-defined metrics</a></li>
<li class="chapter" data-level="8.3" data-path="metrics.html"><a href="metrics.html#metrics-pre-defined"><i class="fa fa-check"></i><b>8.3</b> Pre-defined metrics</a></li>
<li class="chapter" data-level="8.4" data-path="metrics.html"><a href="metrics.html#metrics-3rd-party"><i class="fa fa-check"></i><b>8.4</b> Metrics using 3rd party packages</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="metrics.html"><a href="metrics.html#metrics-lmom"><i class="fa fa-check"></i><b>8.4.1</b> L-moments</a></li>
<li class="chapter" data-level="8.4.2" data-path="metrics.html"><a href="metrics.html#metrics-fractal-dims"><i class="fa fa-check"></i><b>8.4.2</b> Fractal dimensions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cba.html"><a href="cba.html"><i class="fa fa-check"></i><b>9</b> Derived metrics at the cloud level</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cba.html"><a href="cba.html#cba-overview"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="cba.html"><a href="cba.html#cba-applications"><i class="fa fa-check"></i><b>9.2</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="aba.html"><a href="aba.html"><i class="fa fa-check"></i><b>10</b> Derived metrics at the pixel level</a>
<ul>
<li class="chapter" data-level="10.1" data-path="aba.html"><a href="aba.html#aba-overview"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="aba.html"><a href="aba.html#aba-applications"><i class="fa fa-check"></i><b>10.2</b> Applications</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="aba.html"><a href="aba.html#aba-applications-modeling"><i class="fa fa-check"></i><b>10.2.1</b> Modeling</a></li>
<li class="chapter" data-level="10.2.2" data-path="aba.html"><a href="aba.html#aba-applications-density"><i class="fa fa-check"></i><b>10.2.2</b> Density</a></li>
<li class="chapter" data-level="10.2.3" data-path="aba.html"><a href="aba.html#aba-applications-intensity"><i class="fa fa-check"></i><b>10.2.3</b> Intensity</a></li>
<li class="chapter" data-level="10.2.4" data-path="aba.html"><a href="aba.html#aba-applications-other"><i class="fa fa-check"></i><b>10.2.4</b> Other</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="tba.html"><a href="tba.html"><i class="fa fa-check"></i><b>11</b> Derived metrics at the tree level</a>
<ul>
<li class="chapter" data-level="11.1" data-path="tba.html"><a href="tba.html#tba-overview"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="tba.html"><a href="tba.html#tba-applications"><i class="fa fa-check"></i><b>11.2</b> Applications</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="tba.html"><a href="tba.html#tba-applications-tree-selection"><i class="fa fa-check"></i><b>11.2.1</b> Selection of trees</a></li>
<li class="chapter" data-level="11.2.2" data-path="tba.html"><a href="tba.html#tba-applications-tree-inventory"><i class="fa fa-check"></i><b>11.2.2</b> Tree based inventory</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="vba.html"><a href="vba.html"><i class="fa fa-check"></i><b>12</b> Derived metrics at the voxel level</a>
<ul>
<li class="chapter" data-level="12.1" data-path="vba.html"><a href="vba.html#vba-overview"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="vba.html"><a href="vba.html#vba-applications"><i class="fa fa-check"></i><b>12.2</b> Applications</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="pba.html"><a href="pba.html"><i class="fa fa-check"></i><b>13</b> Derived metrics at point level</a>
<ul>
<li class="chapter" data-level="13.1" data-path="pba.html"><a href="pba.html#pba-overview"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="pba.html"><a href="pba.html#pba-applications"><i class="fa fa-check"></i><b>13.2</b> Applications</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="pba.html"><a href="pba.html#pba-applications-roof"><i class="fa fa-check"></i><b>13.2.1</b> Roof segmentation</a></li>
<li class="chapter" data-level="13.2.2" data-path="pba.html"><a href="pba.html#pba-applications-wire"><i class="fa fa-check"></i><b>13.2.2</b> Lake and wire segmentation</a></li>
<li class="chapter" data-level="13.2.3" data-path="pba.html"><a href="pba.html#pba-applications-coloring"><i class="fa fa-check"></i><b>13.2.3</b> Multi-spectral coloring</a></li>
<li class="chapter" data-level="13.2.4" data-path="pba.html"><a href="pba.html#pba-applications-outliers"><i class="fa fa-check"></i><b>13.2.4</b> Outlier filtering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="engine.html"><a href="engine.html"><i class="fa fa-check"></i><b>14</b> <code>LAScatalog</code> processing engine (1/2)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="engine.html"><a href="engine.html#engine-rationale"><i class="fa fa-check"></i><b>14.1</b> Rationale for <code>LAScatalog</code> functionality</a></li>
<li class="chapter" data-level="14.2" data-path="engine.html"><a href="engine.html#engine-engine"><i class="fa fa-check"></i><b>14.2</b> The <code>LAScatalog</code> engine</a></li>
<li class="chapter" data-level="14.3" data-path="engine.html"><a href="engine.html#engine-lascatalog"><i class="fa fa-check"></i><b>14.3</b> Read a collection of files</a></li>
<li class="chapter" data-level="14.4" data-path="engine.html"><a href="engine.html#engine-asprs-compliance"><i class="fa fa-check"></i><b>14.4</b> Validation</a></li>
<li class="chapter" data-level="14.5" data-path="engine.html"><a href="engine.html#engine-clip"><i class="fa fa-check"></i><b>14.5</b> Extract Regions of interest</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="engine.html"><a href="engine.html#engine-clip-single"><i class="fa fa-check"></i><b>14.5.1</b> Extract a single ROI</a></li>
<li class="chapter" data-level="14.5.2" data-path="engine.html"><a href="engine.html#engine-clip-multiple"><i class="fa fa-check"></i><b>14.5.2</b> Multiple extractions</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="engine.html"><a href="engine.html#engine-options"><i class="fa fa-check"></i><b>14.6</b> Modification of default behavior</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="engine.html"><a href="engine.html#engine-options-ondisk"><i class="fa fa-check"></i><b>14.6.1</b> Multiple extractions on disk</a></li>
<li class="chapter" data-level="14.6.2" data-path="engine.html"><a href="engine.html#engine-options-index"><i class="fa fa-check"></i><b>14.6.2</b> Multiple extraction with point cloud indexation</a></li>
<li class="chapter" data-level="14.6.3" data-path="engine.html"><a href="engine.html#summary"><i class="fa fa-check"></i><b>14.6.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="engine.html"><a href="engine.html#engine-gnd-classification"><i class="fa fa-check"></i><b>14.7</b> Ground classification</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="engine.html"><a href="engine.html#engine-options-chunk"><i class="fa fa-check"></i><b>14.7.1</b> Chunk processing</a></li>
<li class="chapter" data-level="14.7.2" data-path="engine.html"><a href="engine.html#engine-options-chunk-buffer"><i class="fa fa-check"></i><b>14.7.2</b> Modifying buffers</a></li>
<li class="chapter" data-level="14.7.3" data-path="engine.html"><a href="engine.html#engine-options-chunk-size"><i class="fa fa-check"></i><b>14.7.3</b> Modify the chunk size</a></li>
<li class="chapter" data-level="14.7.4" data-path="engine.html"><a href="engine.html#engine-options-parallel"><i class="fa fa-check"></i><b>14.7.4</b> Parallel processing</a></li>
<li class="chapter" data-level="14.7.5" data-path="engine.html"><a href="engine.html#summary-1"><i class="fa fa-check"></i><b>14.7.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="engine.html"><a href="engine.html#engine-dtm"><i class="fa fa-check"></i><b>14.8</b> Digital Terrain Model</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="engine.html"><a href="engine.html#engine-dtm-inmemory"><i class="fa fa-check"></i><b>14.8.1</b> In memory DTM</a></li>
<li class="chapter" data-level="14.8.2" data-path="engine.html"><a href="engine.html#engine-dtm-ondisk"><i class="fa fa-check"></i><b>14.8.2</b> On disk DTM</a></li>
<li class="chapter" data-level="14.8.3" data-path="engine.html"><a href="engine.html#summary-2"><i class="fa fa-check"></i><b>14.8.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="engine.html"><a href="engine.html#engine-normalization"><i class="fa fa-check"></i><b>14.9</b> Height normalization</a></li>
<li class="chapter" data-level="14.10" data-path="engine.html"><a href="engine.html#engine-aba"><i class="fa fa-check"></i><b>14.10</b> Area Based Approach</a>
<ul>
<li class="chapter" data-level="14.10.1" data-path="engine.html"><a href="engine.html#summary-3"><i class="fa fa-check"></i><b>14.10.1</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14.11" data-path="engine.html"><a href="engine.html#engine-itd"><i class="fa fa-check"></i><b>14.11</b> Individual Tree Detection</a>
<ul>
<li class="chapter" data-level="14.11.1" data-path="engine.html"><a href="engine.html#summary-4"><i class="fa fa-check"></i><b>14.11.1</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14.12" data-path="engine.html"><a href="engine.html#engine-its"><i class="fa fa-check"></i><b>14.12</b> Individual Tree Segmentation</a></li>
<li class="chapter" data-level="14.13" data-path="engine.html"><a href="engine.html#engine-retile"><i class="fa fa-check"></i><b>14.13</b> Retile a catalog</a>
<ul>
<li class="chapter" data-level="14.13.1" data-path="engine.html"><a href="engine.html#retile-a-catalog-into-smaller-files"><i class="fa fa-check"></i><b>14.13.1</b> Retile a catalog into smaller files</a></li>
<li class="chapter" data-level="14.13.2" data-path="engine.html"><a href="engine.html#add-a-buffer-around-each-file"><i class="fa fa-check"></i><b>14.13.2</b> Add a buffer around each file</a></li>
<li class="chapter" data-level="14.13.3" data-path="engine.html"><a href="engine.html#create-a-new-collection-with-only-first-returns"><i class="fa fa-check"></i><b>14.13.3</b> Create a new collection with only first returns</a></li>
<li class="chapter" data-level="14.13.4" data-path="engine.html"><a href="engine.html#create-a-new-collection-of-small-and-buffered-ground-returns-in-parallel"><i class="fa fa-check"></i><b>14.13.4</b> Create a new collection of small and buffered ground returns in parallel</a></li>
</ul></li>
<li class="chapter" data-level="14.14" data-path="engine.html"><a href="engine.html#engine-independent-files"><i class="fa fa-check"></i><b>14.14</b> The case of ground inventories</a></li>
<li class="chapter" data-level="14.15" data-path="engine.html"><a href="engine.html#engine-summary-sheet"><i class="fa fa-check"></i><b>14.15</b> Summary of available options</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="engine2.html"><a href="engine2.html"><i class="fa fa-check"></i><b>15</b> LAScatalog processing engine (2/2)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="engine2.html"><a href="engine2.html#engine-catalog-apply"><i class="fa fa-check"></i><b>15.1</b> <code>catalog_apply()</code></a></li>
<li class="chapter" data-level="15.2" data-path="engine2.html"><a href="engine2.html#engine-user-function-generic"><i class="fa fa-check"></i><b>15.2</b> Create user-defined function</a></li>
<li class="chapter" data-level="15.3" data-path="engine2.html"><a href="engine2.html#engine-user-function-extended"><i class="fa fa-check"></i><b>15.3</b> Create an intermediate function for <code>catalog_apply()</code></a></li>
<li class="chapter" data-level="15.4" data-path="engine2.html"><a href="engine2.html#engine-user-function-lascatalog"><i class="fa fa-check"></i><b>15.4</b> Make a user-friendly function for third party users</a></li>
<li class="chapter" data-level="15.5" data-path="engine2.html"><a href="engine2.html#engine-user-function-safe"><i class="fa fa-check"></i><b>15.5</b> Make a safe function for third party users</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modeling-aba.html"><a href="modeling-aba.html"><i class="fa fa-check"></i><b>16</b> The Area-Based Approach (ABA) to forest modelling</a>
<ul>
<li class="chapter" data-level="16.1" data-path="modeling-aba.html"><a href="modeling-aba.html#modeling-read-data"><i class="fa fa-check"></i><b>16.1</b> Read in data</a></li>
<li class="chapter" data-level="16.2" data-path="modeling-aba.html"><a href="modeling-aba.html#modeling-build-data"><i class="fa fa-check"></i><b>16.2</b> ABA database building</a></li>
<li class="chapter" data-level="16.3" data-path="modeling-aba.html"><a href="modeling-aba.html#modeling-build-model"><i class="fa fa-check"></i><b>16.3</b> Statistical modeling</a></li>
<li class="chapter" data-level="16.4" data-path="modeling-aba.html"><a href="modeling-aba.html#wall-to-wall-modelling"><i class="fa fa-check"></i><b>16.4</b> Wall to wall modelling</a></li>
<li class="chapter" data-level="16.5" data-path="modeling-aba.html"><a href="modeling-aba.html#calculate-wall-to-wall-predictions"><i class="fa fa-check"></i><b>16.5</b> Calculate wall-to-wall predictions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="outbox.html"><a href="outbox.html"><i class="fa fa-check"></i><b>17</b> Thinking outside the box</a>
<ul>
<li class="chapter" data-level="17.1" data-path="outbox.html"><a href="outbox.html#outbox-custom-metrics"><i class="fa fa-check"></i><b>17.1</b> New complex metrics in ABA</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="outbox.html"><a href="outbox.html#outbox-distance-returns"><i class="fa fa-check"></i><b>17.1.1</b> Distance between returns</a></li>
<li class="chapter" data-level="17.1.2" data-path="outbox.html"><a href="outbox.html#outbox-rumple-index"><i class="fa fa-check"></i><b>17.1.2</b> Rumple index</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="outbox.html"><a href="outbox.html#outbox-multispectral-coloring"><i class="fa fa-check"></i><b>17.2</b> Multi-spectral coloring</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="spatial-indexing.html"><a href="spatial-indexing.html"><i class="fa fa-check"></i><b>18</b> Spatial indexing</a>
<ul>
<li class="chapter" data-level="18.1" data-path="spatial-indexing.html"><a href="spatial-indexing.html#spatial-indexing-intro"><i class="fa fa-check"></i><b>18.1</b> Introduction to spatial indexes</a></li>
<li class="chapter" data-level="18.2" data-path="spatial-indexing.html"><a href="spatial-indexing.html#spatial-indexing-las"><i class="fa fa-check"></i><b>18.2</b> Spatial indexes for LAS objects</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="spatial-indexing.html"><a href="spatial-indexing.html#spatial-indexing-oveview"><i class="fa fa-check"></i><b>18.2.1</b> Overview</a></li>
<li class="chapter" data-level="18.2.2" data-path="spatial-indexing.html"><a href="spatial-indexing.html#spatial-indexing-strategies"><i class="fa fa-check"></i><b>18.2.2</b> Spatial indexes and selection strategies</a></li>
<li class="chapter" data-level="18.2.3" data-path="spatial-indexing.html"><a href="spatial-indexing.html#spatial-indexing-cpp-api"><i class="fa fa-check"></i><b>18.2.3</b> C++ API</a></li>
<li class="chapter" data-level="18.2.4" data-path="spatial-indexing.html"><a href="spatial-indexing.html#spatial-indexing-benchmark"><i class="fa fa-check"></i><b>18.2.4</b> Benchmark</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="spatial-indexing.html"><a href="spatial-indexing.html#spatial-indexing-files"><i class="fa fa-check"></i><b>18.3</b> Spatial index for LAS files</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="plugins.html"><a href="plugins.html"><i class="fa fa-check"></i><b>19</b> <code>lidR</code> plugin system</a>
<ul>
<li class="chapter" data-level="19.1" data-path="plugins.html"><a href="plugins.html#plugin-system"><i class="fa fa-check"></i><b>19.1</b> Understanding lidR algorithms</a></li>
<li class="chapter" data-level="19.2" data-path="plugins.html"><a href="plugins.html#plugin-creation"><i class="fa fa-check"></i><b>19.2</b> Creation of the <code>mba</code> algorithm</a></li>
<li class="chapter" data-level="19.3" data-path="plugins.html"><a href="plugins.html#plugin-extensions"><i class="fa fa-check"></i><b>19.3</b> What about other algorithms?</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="cpp-api.html"><a href="cpp-api.html"><i class="fa fa-check"></i><b>20</b> C++ API</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The <code>lidR</code> package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="io" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Reading, Plotting, Querying &amp; Validating<a href="io.html#io" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="read" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Reading LiDAR data using <code>readLAS</code><a href="io.html#read" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Discrete return ALS sensors record a number of pieces of data. First and foremost, positional data in three dimensions (X,Y,Z), followed by additional information like the intensity for each point, the position of each point in the return sequence, or the beam incidence angle of each point. Reading, writing, and efficient storage of these ALS data is a critical step prior to any subsequent analysis.</p>
<p>ALS data is most commonly distributed in LAS format, which is specifically designed to store ALS data in a standardized way. These data are officially documented and maintained by the <a href="http://www.asprs.org/wp-content/uploads/2019/07/LAS_1_4_r15.pdf">American Society for Photogrammetry &amp; Remote Sensing (ASPRS)</a>. LAS files do however require a large amount of memory because they are not compressed. The LAZ format has become the standard compression scheme, because it is free and open-source.</p>
<p>The widespread use, standardization and open source nature of the LAS and LAZ formats promoted the development of the <code>lidR</code> package, which has been designed to process LAS and LAZ files both as input and output, taking advantage of the LASlib and LASzip C++ libraries via the <a href="https://cran.r-project.org/package=rlas"><code>rlas</code></a> package.</p>
<p>The function <code>readLAS()</code> reads a LAS or LAZ file and returns an object of class <code>LAS</code>. The <code>LAS</code> formal class is documented in depth in a <a href="https://cran.r-project.org/web/packages/lidR/vignettes/lidR-LAS-class.html">dedicated vignette</a>. To briefly summarize, a LAS file is made of two parts:</p>
<ol style="list-style-type: decimal">
<li>The header that stores summary information about its content including the bounding box of the file, coordinate reference system, and point format.</li>
<li>The payload - i.e. the point cloud itself.</li>
</ol>
<p>The function <code>readLAS()</code> reads and creates an object that contains both the header and the payload.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="io.html#cb2-1" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;files.las&quot;</span>)</span></code></pre></div>
<p>When printed it displays a summary of its content.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="io.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(las)</span>
<span id="cb3-2"><a href="io.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; class        : LAS (v1.2 format 1)</span></span>
<span id="cb3-3"><a href="io.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; memory       : 4.4 Mb </span></span>
<span id="cb3-4"><a href="io.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; extent       : 684766.4, 684993.3, 5017773, 5018007 (xmin, xmax, ymin, ymax)</span></span>
<span id="cb3-5"><a href="io.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; coord. ref.  : NAD83 / UTM zone 17N </span></span>
<span id="cb3-6"><a href="io.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; area         : 51572 m²</span></span>
<span id="cb3-7"><a href="io.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; points       : 81.6 thousand points</span></span>
<span id="cb3-8"><a href="io.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; density      : 1.58 points/m²</span></span>
<span id="cb3-9"><a href="io.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; density      : 1.08 pulses/m²</span></span></code></pre></div>
<p>For a more in-depth print out of the data use the function <code>summary()</code> instead of <code>print()</code>.</p>
<div id="select" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Parameter <code>select</code><a href="io.html#select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A LAS file stores the <code>X Y Z</code> coordinates of each point as well as many other data such as intensity, incidence angle, and return sequence position. We call these data <em>attributes</em>. In pratice many attributes are not actually useful but they are loaded anyway by default. This can take up a lot of processing memory because R is a language that does not allow for choosing data storage modes (see <a href="(https://cran.r-project.org/web/packages/lidR/vignettes/lidR-LAS-class.html)">this vignette</a> for more details).</p>
<p>To save memory, <code>readLAS()</code> can take an optional parameter <code>select</code> which enables the user to selectively load the attributes of interest. For example, one can choose to load only the <code>X Y Z</code> attributes.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="io.html#cb4-1" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;file.las&quot;</span>, <span class="at">select =</span> <span class="st">&quot;xyz&quot;</span>)  <span class="co"># load XYZ only</span></span>
<span id="cb4-2"><a href="io.html#cb4-2" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;file.las&quot;</span>, <span class="at">select =</span> <span class="st">&quot;xyzi&quot;</span>) <span class="co"># load XYZ and intensity only</span></span></code></pre></div>
<p>Examples of other attribute abbreviations are: <code>t</code> - gpstime, <code>a</code> - scan angle, <code>n</code> - number of returns, <code>r</code> - return number, <code>c</code> - classification, <code>s</code> - synthetic flag, <code>k</code> - keypoint flag, <code>w</code> - withheld flag, <code>o</code> - overlap flag (format 6+), <code>u</code> - user data, <code>p</code> - point source ID, <code>e</code> - edge of flight line flag, <code>d</code> - direction of scan flag</p>
</div>
<div id="filter" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Parameter <code>filter</code><a href="io.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While <code>select</code> enables the user to select “columns” (or attributes) while reading files, <code>filter</code> allows selection of “rows” (or points) while reading. Removing superfluous data at reading time saves memory and increases computation speed. For example, it’s common practice in forestry to process using first returns.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="io.html#cb5-1" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;file.las&quot;</span>, <span class="at">filter =</span> <span class="st">&quot;-keep_first&quot;</span>) <span class="co"># Read only first returns</span></span></code></pre></div>
<p>It is important to understand that the option <code>filter</code> in <code>readLAS()</code> keeps or discards point <strong>at read time</strong> i.e. while reading at the C++ level without implying any R code. For example the R function to filter points of interest (POI) is <code>filter_poi()</code> may return the exact same output as the <code>filter</code> option in <code>readLAS()</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="io.html#cb6-1" aria-hidden="true" tabindex="-1"></a>las1 <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;file.las&quot;</span>, <span class="at">filter =</span> <span class="st">&quot;-keep_first&quot;</span>)</span>
<span id="cb6-2"><a href="io.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="io.html#cb6-3" aria-hidden="true" tabindex="-1"></a>las2 <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;file.las&quot;</span>)</span>
<span id="cb6-4"><a href="io.html#cb6-4" aria-hidden="true" tabindex="-1"></a>las2 <span class="ot">&lt;-</span> <span class="fu">filter_poi</span>(las2, ReturnNumber <span class="sc">==</span> 1L)</span></code></pre></div>
<p>In the above example we are (1) reading only the first returns or (2) Reading all the points then filtering the first returns in R. Both outputs are strictly identical but the first one is faster and more memory efficient because it doesn’t load the whole file in R and does not use extra processing memory. It should always be preferred when possible. Multiple filter commands can be used at once to e.g. read only first return between 5 and 50 m.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="io.html#cb7-1" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span>  <span class="fu">readLAS</span>(<span class="st">&quot;file.las&quot;</span>, <span class="at">filter =</span> <span class="st">&quot;-keep_first -drop_z_below 5 -drop_z_above 50&quot;</span>)</span></code></pre></div>
<p>The full list of available commands is given by <code>readLAS(filter = "-help")</code>. Users of <code>LAStools</code> may recognize these commands because both <code>LAStools</code> and <code>lidR</code> use the same library (<code>LASlib</code> and <code>LASzip</code>) to read and write LAS and LAZ files.</p>
</div>
</div>
<div id="asprs-compliance" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Validating lidar data<a href="io.html#asprs-compliance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An important first step in ALS data processing is ensuring that your data is complete and valid according to the <a href="http://www.asprs.org/wp-content/uploads/2019/07/LAS_1_4_r15.pdf">ASPRS LAS specifications</a>. Users commonly report bugs arising from invalid data. This is why we introduced the <code>las_check()</code> function to perform a deep inspection of <code>LAS</code> objects. This function checks if a <code>LAS</code> object meets the ASPRS LAS specifications and whether it is valid for processing, giving warnings if otherwise.</p>
<p>A simple example that happens fairly often is that a <code>LAS</code> file contains duplicate points. This may lead to problems like trees being detected twice, to invalid metrics, or to errors in DTM generation. We can also encounter invalid return numbers, incoherent return numbers and number of returns attributes, invalid coordinate reference system etc. Always make sure to run the <code>las_check()</code> function before digging deep into your data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="io.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">las_check</span>(las)</span></code></pre></div>
<PRE class="fansi fansi-output"><CODE>#&gt; 
#&gt;  Checking the data
#&gt;   - Checking coordinates...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking coordinates type...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking coordinates range...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking coordinates quantization...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking attributes type...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking ReturnNumber validity...
#&gt;  <span style='color: #BBBB00; font-weight: bold;'>   ⚠ Invalid data: 1 points with a return number equal to 0 found.</span>
#&gt;   - Checking NumberOfReturns validity...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking ReturnNumber vs. NumberOfReturns...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking RGB validity...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking absence of NAs...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking duplicated points...
#&gt;  <span style='color: #BBBB00; font-weight: bold;'>   ⚠ 1 points are duplicated and share XYZ coordinates with other points</span>
#&gt;   - Checking degenerated ground points...
#&gt;  <span style='color: #BBBB00; font-weight: bold;'>   ⚠ There were 1 degenerated ground points. Some X Y Z coordinates were repeated</span>
#&gt;   - Checking attribute population...
#&gt;  <span style='color: #00BB00;'>   🛈 &#039;PointSourceID&#039; attribute is not populated</span>
#&gt;  <span style='color: #00BB00;'>   🛈 &#039;EdgeOfFlightline&#039; attribute is not populated</span>
#&gt;   - Checking gpstime incoherances<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking flag attributes...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking user data attribute...<span style='color: #00BB00;'> ✓</span>
#&gt;  Checking the header
#&gt;   - Checking header completeness...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking scale factor validity...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking point data format ID validity...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking extra bytes attributes validity...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking the bounding box validity...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking coordinate reference system...<span style='color: #00BB00;'> ✓</span>
#&gt;  Checking header vs data adequacy
#&gt;   - Checking attributes vs. point format...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking header bbox vs. actual content...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking header number of points vs. actual content...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking header return number vs. actual content...
#&gt;  <span style='color: #BBBB00; font-weight: bold;'>   ⚠ Invalid file: the header states the file contains 55756 returns numbered &#039;1&#039; but 55755 were found.</span>
#&gt;  Checking coordinate reference system...
#&gt;   - Checking if the CRS was understood by R...<span style='color: #00BB00;'> ✓</span>
#&gt;  Checking preprocessing already done 
#&gt;   - Checking ground classification...<span style='color: #00BB00;'> yes</span>
#&gt;   - Checking normalization...<span style='color: #00BB00;'> yes</span>
#&gt;   - Checking negative outliers...<span style='color: #00BB00;'> ✓</span>
#&gt;   - Checking flightline classification...<span style='color: #BB0000;'> no</span>
#&gt;  Checking compression
#&gt;   - Checking attribute compression...
#&gt;    -  EdgeOfFlightline is compressed
#&gt;    -  Synthetic_flag is compressed
#&gt;    -  Keypoint_flag is compressed
#&gt;    -  Withheld_flag is compressed
#&gt;    -  UserData is compressed
#&gt;    -  PointSourceID is compressed
</CODE></PRE>
<p>A check is performed at read time regardless, but the read time check is not as thorough as <code>las_check()</code> for computation time reasons. For example duplicated points are not checked at read time.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="io.html#cb9-1" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(<span class="st">&quot;data/chap1/corrupted.laz&quot;</span>)</span>
<span id="cb9-2"><a href="io.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Invalid data: 174638 points with a &#39;return number&#39; greater than the</span></span>
<span id="cb9-3"><a href="io.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;number of returns&#39;.</span></span></code></pre></div>
</div>
<div id="plot" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Plotting<a href="io.html#plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>lidR</code> package takes advantage of the <a href="https://cran.r-project.org/package=rgl"><code>rgl</code></a> package to provide a versatile and interactive 3D viewer with points coloured by Z coordinates on a black background as default.</p>
<div id="plot-3d" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Basic 3D rendering<a href="io.html#plot-3d" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The very basic way to render a point cloud is the function <code>plot()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="io.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(las)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-las-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Users can change the attributes used for coloring by providing the name of the attribute used to colorize the points. The background color of the viewer can also be changed by assigning a color using the <code>bg</code> argument. Axes can also be added and point sizes can be changed.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="io.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot las object by scan angle, </span></span>
<span id="cb11-2"><a href="io.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># make the background white, </span></span>
<span id="cb11-3"><a href="io.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># display XYZ axis and  scale colors</span></span>
<span id="cb11-4"><a href="io.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(las, <span class="at">color =</span> <span class="st">&quot;ScanAngleRank&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">axis =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-las-custom-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Note that if your file contains RGB data the string <code>"RGB"</code> is supported:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="io.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(las, <span class="at">color =</span><span class="st">&quot;RGB&quot;</span>)</span></code></pre></div>
<p>The argument <code>breaks</code> enables to defined more adequate breaks in the color palette for example when intensity contains large outliers. Otherwise the palette range would be too large and most of the values would be considered as “very low”, so everything would appear in the same color.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="io.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(las, <span class="at">color =</span> <span class="st">&quot;Intensity&quot;</span>, <span class="at">breaks =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-las-fail-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-overlay" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Overlays<a href="io.html#plot-overlay" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The package also provides some easy to use functions for common overlay. For example <code>add_dtm3d()</code> to add a digital terrain model (section <a href="dtm.html#dtm">4</a>) and <code>add_treetops3d()</code> to visualize the output of an individual tree detection (section <a href="itd-its.html#itd">7.1</a>)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="io.html#cb14-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">plot</span>(las, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb14-2"><a href="io.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_dtm3d</span>(x, dtm)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-las-dtm-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="io.html#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">plot</span>(las, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb15-2"><a href="io.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">add_treetops3d</span>(x, ttops)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-las-trees-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>It is also possible to combine two point clouds with different colour palettes. In the following example we are using a previously classified point cloud. We first separate the vegetation and non vegetation points using <code>filter_poi()</code> and then plot both on top of each other with different colour schemes using <code>add</code> options in <code>plot()</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="io.html#cb16-1" aria-hidden="true" tabindex="-1"></a>nonveg <span class="ot">&lt;-</span> <span class="fu">filter_poi</span>(las, Classification <span class="sc">!=</span> LASHIGHVEGETATION)</span>
<span id="cb16-2"><a href="io.html#cb16-2" aria-hidden="true" tabindex="-1"></a>veg <span class="ot">&lt;-</span> <span class="fu">filter_poi</span>(las, Classification <span class="sc">==</span> LASHIGHVEGETATION)</span>
<span id="cb16-3"><a href="io.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="io.html#cb16-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">plot</span>(nonveg, <span class="at">color =</span> <span class="st">&quot;Classification&quot;</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb16-5"><a href="io.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(veg, <span class="at">add =</span> x)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-las-add-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-advanced" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Advanced 3D rendering<a href="io.html#plot-advanced" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With <code>lidR</code> being based on <code>rgl</code> it is easy to add objects in the main rendering using <code>rgl</code> functions such as <code>rgl::point3d()</code>, <code>rgl::text()</code>, <code>rgl::surface3d()</code> and so on to produce publication ready rendering. However <code>lidR</code> introduced an additional challenge because it does not display the points with their actual coordinates. The points are shifted to be rendered close to (0, 0) (a matter of accuracy because <code>rgl</code> uses <code>float</code> (decimal numbers on 32 bits) instead of <code>double</code> (decimal numbers on 64 bits)). When <code>plot()</code> is used it invisibly returns the shift values that can be used later to realign other objects.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="io.html#cb17-1" aria-hidden="true" tabindex="-1"></a>offsets <span class="ot">&lt;-</span> <span class="fu">plot</span>(las)</span>
<span id="cb17-2"><a href="io.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(offsets)</span>
<span id="cb17-3"><a href="io.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  391867.8 3901019.3</span></span></code></pre></div>
<p>The coordinates of the objects must be corrected to align with the point cloud. In the following we will add lines to render the trunks. We read a file, we locate the trees (see section <a href="itd-its.html#itd">7.1</a>), we extract the coordinates and sizes of the trees and plot lines with <code>rgl::segment3d()</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="io.html#cb18-1" aria-hidden="true" tabindex="-1"></a>LASfile <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;MixedConifer.laz&quot;</span>, <span class="at">package=</span><span class="st">&quot;lidR&quot;</span>)</span>
<span id="cb18-2"><a href="io.html#cb18-2" aria-hidden="true" tabindex="-1"></a>las <span class="ot">&lt;-</span> <span class="fu">readLAS</span>(LASfile, <span class="at">select =</span> <span class="st">&quot;xyzc&quot;</span>)</span>
<span id="cb18-3"><a href="io.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="io.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get the location of the trees</span></span>
<span id="cb18-5"><a href="io.html#cb18-5" aria-hidden="true" tabindex="-1"></a>ttops <span class="ot">&lt;-</span> <span class="fu">locate_trees</span>(las, <span class="fu">lmf</span>(<span class="at">ws =</span> <span class="dv">5</span>)) </span>
<span id="cb18-6"><a href="io.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="io.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the point cloud</span></span>
<span id="cb18-8"><a href="io.html#cb18-8" aria-hidden="true" tabindex="-1"></a>offsets <span class="ot">&lt;-</span> <span class="fu">plot</span>(las, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb18-9"><a href="io.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">add_treetops3d</span>(offsets, ttops)</span>
<span id="cb18-10"><a href="io.html#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="io.html#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the coordinates of the trees and</span></span>
<span id="cb18-12"><a href="io.html#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the shift to display the lines</span></span>
<span id="cb18-13"><a href="io.html#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># in the rendering coordinate system</span></span>
<span id="cb18-14"><a href="io.html#cb18-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(ttops)[,<span class="dv">1</span>] <span class="sc">-</span> offsets[<span class="dv">1</span>] </span>
<span id="cb18-15"><a href="io.html#cb18-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_coordinates</span>(ttops)[,<span class="dv">2</span>] <span class="sc">-</span> offsets[<span class="dv">2</span>] </span>
<span id="cb18-16"><a href="io.html#cb18-16" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> ttops<span class="sc">$</span>Z</span>
<span id="cb18-17"><a href="io.html#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="io.html#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a GL_LINES matrix for fast rendering</span></span>
<span id="cb18-19"><a href="io.html#cb18-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(x, <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb18-20"><a href="io.html#cb18-20" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(y, <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb18-21"><a href="io.html#cb18-21" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(z)) </span>
<span id="cb18-22"><a href="io.html#cb18-22" aria-hidden="true" tabindex="-1"></a>tmp[<span class="dv">2</span><span class="sc">*</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z)] <span class="ot">&lt;-</span> z</span>
<span id="cb18-23"><a href="io.html#cb18-23" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> tmp</span>
<span id="cb18-24"><a href="io.html#cb18-24" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y,z)</span>
<span id="cb18-25"><a href="io.html#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="io.html#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Display lines</span></span>
<span id="cb18-27"><a href="io.html#cb18-27" aria-hidden="true" tabindex="-1"></a>rgl<span class="sc">::</span><span class="fu">segments3d</span>(M, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-las-truncks-1-rgl.png" width="384" style="display: block; margin: auto;" />../../../../../../tmp/Rtmpjse8Mj/file86ca323bbb4cb.png</p>
</div>
<div id="voxel-rendering" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Voxel rendering<a href="io.html#voxel-rendering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is possible to render voxels. This is useful to render the output of the function <code>voxelise_points()</code> or <code>voxel_metrics()</code> for examples.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="io.html#cb19-1" aria-hidden="true" tabindex="-1"></a>vox <span class="ot">&lt;-</span> <span class="fu">voxelize_points</span>(las, <span class="dv">6</span>)</span>
<span id="cb19-2"><a href="io.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vox, <span class="at">voxel =</span> <span class="cn">TRUE</span>, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/plot-voxels-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="plot-crossection" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Cross sections 2D rendering<a href="io.html#plot-crossection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To better visualize the vertical structure of a point cloud, investigate classification results, or compare results of different interpolation routines, a cross section can be plotted. To do that we first need to decide where the cross section is located (i.e. define the beginning and the end) and specify it’s width. The point cloud can then be clipped and the <code>X</code> and <code>Z</code> coordinates used to create the plot.</p>
<p>For example, to create a 100 m long cross section we may define the beginning and the end and then use <code>clip_transect()</code> function to subset the point cloud.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="io.html#cb20-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">273357</span>, <span class="dv">5274357</span>)</span>
<span id="cb20-2"><a href="io.html#cb20-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">273542</span>, <span class="dv">5274542</span>)</span>
<span id="cb20-3"><a href="io.html#cb20-3" aria-hidden="true" tabindex="-1"></a>las_tr <span class="ot">&lt;-</span> <span class="fu">clip_transect</span>(las, p1, p2, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">xz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Rendering can be achieved with base plot or <code>ggplot2</code>. Notice the use of <code>@data</code> to extract the <code>data.frame</code> from the <code>LAS</code> object.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="io.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb21-2"><a href="io.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="io.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(las_tr<span class="sc">@</span>data, <span class="fu">aes</span>(X,Z, <span class="at">color =</span> Z)) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="io.html#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="io.html#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span> </span>
<span id="cb21-6"><a href="io.html#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-7"><a href="io.html#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">height.colors</span>(<span class="dv">50</span>))</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/ggplot-transect-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The two steps required to create a cross section (clipping the point cloud and plotting) can be combined. Below we create a simple function that will become handy at multiple occasions throughout this book. To make this function even easier to use we will specify the default values for <code>p1</code> and <code>p2</code> so that the cross section is located in the centre of the point cloud, along the X-axis. The default width will be 4 m.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="io.html#cb22-1" aria-hidden="true" tabindex="-1"></a>plot_crossection <span class="ot">&lt;-</span> <span class="cf">function</span>(las,</span>
<span id="cb22-2"><a href="io.html#cb22-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p1 =</span> <span class="fu">c</span>(<span class="fu">min</span>(las<span class="sc">@</span>data<span class="sc">$</span>X), <span class="fu">mean</span>(las<span class="sc">@</span>data<span class="sc">$</span>Y)),</span>
<span id="cb22-3"><a href="io.html#cb22-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">p2 =</span> <span class="fu">c</span>(<span class="fu">max</span>(las<span class="sc">@</span>data<span class="sc">$</span>X), <span class="fu">mean</span>(las<span class="sc">@</span>data<span class="sc">$</span>Y)),</span>
<span id="cb22-4"><a href="io.html#cb22-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">width =</span> <span class="dv">4</span>, <span class="at">colour_by =</span> <span class="cn">NULL</span>)</span>
<span id="cb22-5"><a href="io.html#cb22-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb22-6"><a href="io.html#cb22-6" aria-hidden="true" tabindex="-1"></a>  colour_by <span class="ot">&lt;-</span> rlang<span class="sc">::</span><span class="fu">enquo</span>(colour_by)</span>
<span id="cb22-7"><a href="io.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  data_clip <span class="ot">&lt;-</span> <span class="fu">clip_transect</span>(las, p1, p2, width)</span>
<span id="cb22-8"><a href="io.html#cb22-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_clip<span class="sc">@</span>data, <span class="fu">aes</span>(X,Z)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">coord_equal</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span>
<span id="cb22-9"><a href="io.html#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="io.html#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(colour_by))</span>
<span id="cb22-11"><a href="io.html#cb22-11" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">color =</span> <span class="sc">!!</span>colour_by) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb22-12"><a href="io.html#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="io.html#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb22-14"><a href="io.html#cb22-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we can used the function:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="io.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_crossection</span>(las, <span class="at">colour_by =</span> <span class="fu">factor</span>(Classification))</span></code></pre></div>
<p><img src="lidR-book_files/figure-html/ggplot-transect-2-1.png" width="768" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<script async src="//static.getclicky.com/101377207.js"></script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101377207ns.gif" /></p></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="gnd.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
